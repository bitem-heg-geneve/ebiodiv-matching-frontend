(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["home~occurrence~occurrenceList"],{"0303":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:t.bannerCssClasses,style:t.cssVars},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12"},[s("div",{staticClass:"float-start position-absolute"},[s("a",{attrs:{href:t.baseUrl}},[s("img",{staticClass:"medium-img",attrs:{src:n("dd27")}})])]),s("h1",[t._v(t._s(t.title))]),s("p",[s("i",[t._v(t._s(t.subtitle))])])])]),s("div",{staticClass:"user-login-container"},[s("b-nav",[s("b-nav-item",{attrs:{href:"https://ebiodiv.org/","link-classes":"ebiodiv_navbar_link",target:"_blank"}},[s("b-icon-info-circle"),t._v(" About")],1)],1),s("UserComponent")],1)])},i=[],a=n("5530"),c=(n("ac1f"),n("5319"),n("2f62")),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-login"},[t.user.name?[n("div",{attrs:{id:"loginName"}},[n("b-icon",{attrs:{icon:"person-fill"}}),t._v(" "+t._s(t.user.name))],1),n("b-popover",{attrs:{target:"loginName",triggers:"hover",placement:"bottomright",delay:{show:50,hide:400}}},[n("b-container",[n("b-row",{staticClass:"mb-2 mt-2"},[n("b-col",[t._v("ORCID "),n("a",{attrs:{href:t.userOrcidUrl,target:"_blank"}},[t._v(t._s(t.user.orcid))])])],1),n("b-row",{staticClass:"mb-2 mt-2"},[n("b-col",[n("b-button",{attrs:{variant:"outline-danger",size:"sm"},on:{click:t.logout}},[t._v("Log out")])],1)],1)],1)],1)]:[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"loginForm",expression:"'loginForm'"}],attrs:{size:"sm",id:"loginName"}},[n("b-icon",{attrs:{icon:"person-fill"}}),t._v(" Login")],1),n("b-modal",{attrs:{id:"loginForm",title:"Login with your ORCID","hide-footer":!0},on:{show:t.onLoginShow,hide:t.onLoginHide}},[n("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-body mx-auto"},[n("div",[n("a",{staticClass:"btn btn-outline-primary",attrs:{id:"oauthLink",href:t.authUrl,role:"button",target:"_blank",rel:"opener"},on:{click:t.startOAuth}},[n("img",{attrs:{src:"orcid_24x24.webp"}}),t._v(" Connect your ORCID")])])])])])])]],2)},r=[],l=n("1da1"),u=(n("b0c0"),n("96cf"),{name:"UserComponent",data:function(){return{authUrl:null,pendingLogin:!1}},computed:Object(a["a"])(Object(a["a"])({},Object(c["c"])(["user"])),{},{userOrcidUrl:function(){return null!=this.$orcid.config?this.$orcid.config.issuer+"/"+this.user.orcid:"https://orcid.org/"+this.user.orcid}}),methods:Object(a["a"])(Object(a["a"])({},Object(c["b"])(["updateOrcidUser"])),{},{onLoginShow:function(){this.pendingLogin=!0},onLoginHide:function(){this.pendingLogin&&this.$emitter.emit("loginAbort"),this.pendingLogin=!1},startOAuth:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:window.setOrcidToken=function(e){t.updateOrcidUser(e),window.setOrcidToken=null,t.$emitter.emit("logged")};case 1:case"end":return e.stop()}}),e)})))()},logout:function(){this.$emitter.emit("logout"),this.updateOrcidUser({name:null,orcid:null,orcidToken:null})}}),mounted:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$orcid.getAuthUrl();case 2:t.authUrl=e.sent,t.$emitter.on("logged",(function(){t.pendingLogin=!1})),t.$emitter.on("ensureLogin",(function(){t.user.name?t.$emitter.emit("logged"):t.$bvModal.show("loginForm")}));case 5:case"end":return e.stop()}}),e)})))()}}),d=u,h=(n("286e"),n("2877")),_=Object(h["a"])(d,o,r,!1,null,"e3031a88",null),m=_.exports,p={name:"BannerComponent",components:{UserComponent:m},props:{title:{type:String,required:!0},subtitle:{type:String,required:!0,default:""}},computed:Object(a["a"])(Object(a["a"])({},Object(c["c"])(["theme_color"])),{},{cssVars:function(){return{"--color-main":this.theme_color.main,"--color-secondary":this.theme_color.secondary}},bannerCssClasses:function(){return"banner "+"backend-sandbox.json".replace(".json","").replace("backend-","")+"Backend"},baseUrl:function(){var t="";return""==t?"/":t}})},g=p,f=(n("6c55"),Object(h["a"])(g,s,i,!1,null,"7e89be38",null));e["a"]=f.exports},"043b":function(t,e,n){t.exports=n.p+"img/icon_reduce.72cce8bc.png"},"18eb":function(t,e,n){"use strict";n("e3eb")},2532:function(t,e,n){"use strict";var s=n("23e7"),i=n("e330"),a=n("5a34"),c=n("1d80"),o=n("577e"),r=n("ab13"),l=i("".indexOf);s({target:"String",proto:!0,forced:!r("includes")},{includes:function(t){return!!~l(o(c(this)),o(a(t)),arguments.length>1?arguments[1]:void 0)}})},"286e":function(t,e,n){"use strict";n("beea")},"28b9":function(t,e,n){t.exports=n.p+"img/icon_expand.01503fbf.png"},"2af1":function(t,e,n){var s=n("23e7"),i=n("f748");s({target:"Math",stat:!0},{sign:i})},3952:function(t,e,n){t.exports=n.p+"img/icon_link.0979c4cd.png"},"396c":function(t,e,n){},"3f00":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"component-container",style:t.cssVars},[s("table",[s("tr",{staticClass:"empty-line"},[s("td",{attrs:{colspan:t.curation_characteristics.length+6}},[s("div",{staticClass:"separator"},[s("h2",[s("span",[t._v(t._s(t.get_occurrence_name)+" "+t._s(t.occurrences_selection.key))])])])])]),s("tr",[s("th",[t._v("Key")]),s("th"),t._l(t.curation_characteristics,(function(e){return s("th",{key:e.score+"sp-th"},[t._v(t._s(e.name))])})),s("th",{attrs:{colspan:"3"}}),s("th")],2),s("tr",{staticClass:"reference-entity"},[s("td",[s("a",{attrs:{href:"https://www.gbif.org/occurrence/"+t.occurrences_selection.key,target:"_blank"}},[t._v(t._s(t.occurrences_selection.key))])]),s("td"),t._l(t.curation_characteristics,(function(e){return[e.value?s("td",{key:e.score+"mc_td",class:"cell_"+e.score},[t._v(t._s(t.display_content(t.occurrences_selection,e.value)))]):t._e()]})),s("td",{attrs:{colspan:"3"}}),s("td",[s("button",{staticClass:"button-table",on:{click:function(e){t.expanded=!t.expanded}}},[t.expanded?t._e():s("img",{staticClass:"mini",attrs:{src:n("28b9")}}),t.expanded?s("img",{staticClass:"mini",attrs:{src:n("043b")}}):t._e()])])],2),t.expanded?s("tr",{staticClass:"expanded"},[s("td",{attrs:{colspan:t.curation_characteristics.length+6}},[t.occurrences_selection.verbatimLabel?s("div",{staticClass:"expanded-box"},[t._v(" "+t._s(t.occurrences_selection.verbatimLabel)+" ")]):t._e(),s("div",{staticClass:"expanded-box"},[s("a",{attrs:{href:t.occurrences_selection.references,target:"_blank"}},[t._v("Reference to TreatmentBank")])])])]):t._e(),s("tr",{staticClass:"empty-line"},[s("td",{attrs:{colspan:t.curation_characteristics.length+6}},[s("br"),s("br"),s("div",{staticClass:"separator"},[s("h2",[s("span",[t._v(t._s(t.get_curation_name)+"s associated with the "+t._s(t.get_occurrence_name.toLowerCase())+" "+t._s(t.occurrences_selection.key))])])]),s("p",[t._v(" "+t._s(t.processed_curation.length)+" suggested "+t._s(t.get_curation_name.toLowerCase())+t._s(t.processed_curation.length>1?"s":"")+" to curate ")]),s("p",{staticClass:"notice"},[t._v("Please indicate for each suggested "+t._s(t.get_curation_name.toLowerCase())+" whether it matches the "+t._s(t.get_occurrence_name.toLowerCase())+" or not (Yes / No).")])])]),t.processed_curation.length>0?s("tr",[s("th",[t._v("Key")]),s("th",{on:{click:function(e){return t.sortBy("$global")}}},[t._v("Score")]),t._l(t.curation_characteristics,(function(e){return s("th",{key:e.score+"sp-th",staticClass:"clickable-th",on:{click:function(n){return t.sortBy(e.score)}}},[t._v(t._s(e.name))])})),s("th",[t._v("Yes")]),s("th",[t._v("No")]),s("th",[t._v("Save")]),s("th")],2):t._e(),t._l(t.processed_curation,(function(e){return s("CurationElement",{key:e.object.key,attrs:{curation:e,scores:t.get_scores(t.occurrences_selection,e.object),save:"Save",status_save_all:t.status_save_all},on:{removeOne:t.removeElement,addOne:t.addElement}})})),t._l(t.processed_empty_elements,(function(e){return s("EmptyElement",{key:e.empty_key,attrs:{curation:e,save:"Save",status_save_all:t.status_save_all},on:{removeOne:t.removeElement,addOne:t.addElement}})})),s("tr",{staticClass:"empty-line"},[s("td",{attrs:{colspan:t.curation_characteristics.length+4}},[s("div",{staticClass:"left-container"},[s("a",{on:{click:t.addLine}},[t._v("+ Add another "+t._s(t.get_curation_name.toLowerCase()))])])])]),t.finished_curation.length>0||t.finished_empty_elements.length>0?s("tr",{staticClass:"empty-line"},[s("td",{attrs:{colspan:t.curation_characteristics.length+6}},[s("br"),s("br"),s("img",{directives:[{name:"show",rawName:"v-show",value:!t.show_edit,expression:"!show_edit"}],staticClass:"mini",attrs:{src:n("c5a5"),alt:"[+]"},on:{click:function(e){t.show_edit=!t.show_edit}}}),s("img",{directives:[{name:"show",rawName:"v-show",value:t.show_edit,expression:"show_edit"}],staticClass:"mini",attrs:{src:n("6927"),alt:"[-]"},on:{click:function(e){t.show_edit=!t.show_edit}}}),t._v(" "+t._s(t.finished_curation.length+t.finished_empty_elements.length)+" "+t._s(t.get_curation_name.toLowerCase())),t.finished_curation.length+t.finished_empty_elements.length>1?s("span",[t._v("s")]):t._e(),t._v(" already curated ")])]):t._e(),t.show_edit&&(t.finished_curation.length>0||t.finished_empty_elements.length>0)?s("tr",[s("th",[t._v("Key")]),s("th",[t._v("Score")]),t._l(t.curation_characteristics,(function(e){return s("th",{key:e.score+"sp-th",staticClass:"clickable-th"},[t._v(t._s(e.name))])})),s("th",[t._v("Yes")]),s("th",[t._v("No")]),s("th",[t._v("Edit")]),s("th")],2):t._e(),t.show_edit&&t.finished_curation.length>0?t._l(t.finished_curation,(function(e){return s("CurationElement",{key:e.object.key,attrs:{curation:e,scores:t.get_scores(t.occurrences_selection,e.object),save:"Edit",status_save_all:t.status_save_all},on:{removeOne:t.removeElement,addOne:t.addElement}})})):t._e(),t.show_edit&&t.finished_empty_elements.length>0?t._l(t.finished_empty_elements,(function(e){return s("EmptyElement",{key:e.empty_key,attrs:{curation:e,save:"Edit",status_save_all:t.status_save_all},on:{removeOne:t.removeElement,addOne:t.addElement}})})):t._e()],2),s("div",[s("div",{staticClass:"button-container"},[t.show_back_button?s("button",{staticClass:"secondary",on:{click:function(e){return t.back()}}},[t._v("Back to list")]):t._e(),s("button",{attrs:{disabled:t.to_disable},on:{click:function(e){return t.save()}}},[t._v("Save")])]),t._m(0)])])},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"left-container"},[n("h3",[t._v("Color legend for the matching score")]),n("table",{staticClass:"legend-table"},[n("tr",[n("td",[n("div",{staticClass:"color-box cell-color-1"})]),n("td",[n("div",{staticClass:"color-box cell-color-2"})]),n("td",[n("div",{staticClass:"color-box cell-color-3"})]),n("td",[n("div",{staticClass:"color-box cell-color-4"})]),n("td",[n("div",{staticClass:"color-box cell-color-5"})]),n("td",[n("div",{staticClass:"color-box cell-color-6"})]),n("td",[n("div",{staticClass:"color-box cell-color-7"})]),n("td",[n("div",{staticClass:"color-box cell-color-8"})]),n("td",[n("div",{staticClass:"color-box cell-color-9"})]),n("td",[n("div",{staticClass:"color-box cell-color-10"})]),n("td",[n("div",{staticClass:"color-box cell-color-11"})])]),n("tr",[n("td",[t._v("1")]),n("td",[t._v("0.9")]),n("td",[t._v("0.8")]),n("td",[t._v("0.7")]),n("td",[t._v("0.6")]),n("td",[t._v("0.5")]),n("td",[t._v("0.4")]),n("td",[t._v("0.3")]),n("td",[t._v("0.2")]),n("td",[t._v("0.1")]),n("td",[t._v("0.0")])])])])}],a=n("b85c"),c=n("5530"),o=(n("b0c0"),n("fb6a"),n("4e82"),n("4de4"),n("d3b7"),n("ac1f"),n("466d"),n("b64b"),n("a434"),n("caad"),n("2532"),n("00b4"),n("07ac"),n("2f62")),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tbody",[s("tr",[s("td",[s("a",{attrs:{href:"https://www.gbif.org/occurrence/"+t.curation.object.key,target:"_blank"}},[t._v(t._s(t.curation.object.key))])]),s("td",{class:t.cellColor(t.scores.$global)},[t._v(t._s(t.scores.$global))]),t._l(t.curation_characteristics,(function(e){return s("td",{key:e.score+"sp-td",class:"cell_"+e.score+" "+t.cellColor(t.scores[e.score])},[t._v(" "+t._s(t.display_content(t.curation.object,e.value))+" ")])})),s("td",[s("input",{attrs:{type:"checkbox"},domProps:{checked:t.is_yes_selected},on:{click:function(e){return t.changeSelection(e,"yes")}}})]),s("td",[s("input",{attrs:{type:"checkbox"},domProps:{checked:t.is_no_selected},on:{click:function(e){return t.changeSelection(e,"no")}}})]),s("td",[s("button",{attrs:{disabled:t.to_disable},on:{click:function(e){return t.saveSelection()}}},[t._v(t._s(t.save))])]),s("td",[t.curation.object.verbatimLabel?s("button",{staticClass:"button-table",on:{click:function(e){t.expanded=!t.expanded}}},[t.expanded?t._e():s("img",{staticClass:"mini",attrs:{src:n("28b9")}}),t.expanded?s("img",{staticClass:"mini",attrs:{src:n("043b")}}):t._e()]):t._e()])],2),t.expanded?s("tr",{staticClass:"expanded"},[s("td"),s("td",{staticClass:"cell-color-na",attrs:{colspan:t.curation_characteristics.length+1}},[t.curation.object.verbatimLabel?s("div",{staticClass:"expanded-box"},[t._v(" "+t._s(t.curation.object.verbatimLabel)+" ")]):t._e(),s("div",{staticClass:"expanded-box"},[s("a",{attrs:{href:t.curation.object.references,target:"_blank"}},[t._v("Reference to TreatmentBank")])])]),s("td",{attrs:{colspan:"4"}})]):t._e()])},l=[],u=n("eb5f"),d={name:"CurationElement",mixins:[u["a"].mixin_fields],components:{},props:{curation:{type:Object,required:!0},scores:{type:Object,required:!0},save:{type:String,default:"Save"},status_save_all:{}},data:function(){return{status:null,saved_status:null,expanded:!1,pendingSave:!1}},computed:Object(c["a"])(Object(c["a"])({},Object(o["c"])(["theme_color","urls","curation_characteristics","fields","format_selection","occurrences_selection","user"])),{},{cssVars:function(){return{"--color":this.theme_color.main}},get_occurrence_name:function(){return this.fields[this.format_selection].format_occurrence.name},get_curation_name:function(){return this.fields[this.format_selection].format_curation.name},is_yes_selected:function(){return"yes"==this.status},is_no_selected:function(){return"no"==this.status},to_disable:function(){return 1==this.curation.matching.match&&1==this.is_yes_selected||(0==this.curation.matching.match&&1==this.is_no_selected||null==this.curation.matching.match&&0==this.is_yes_selected&&0==this.is_no_selected)}}),methods:Object(c["a"])(Object(c["a"])({},Object(o["b"])(["updateUsername"])),{},{normalizeValue:function(t){return null==t?"NA":t},cellColor:function(t){var e="cell-color-na";return null==t?e="cell-color-na":t>=1?e="cell-color-1":t>=.9?e="cell-color-2":t>=.8?e="cell-color-3":t>=.7?e="cell-color-4":t>=.6?e="cell-color-5":t>=.5?e="cell-color-6":t>=.4?e="cell-color-7":t>=.3?e="cell-color-8":t>=.2?e="cell-color-9":t>=.1?e="cell-color-10":t>=0&&(e="cell-color-11"),e},changeSelection:function(t,e){"yes"==e?(1==t.target.checked&&(this.status="yes"),0==t.target.checked&&(this.status="unknown")):"no"==e&&(1==t.target.checked&&(this.status="no"),0==t.target.checked&&(this.status="unknown"));var n=null;"yes"==this.status&&(n=!0),"no"==this.status&&(n=!1),this.status!=this.saved_status?this.$emit("addOne",{key:this.curation.object.key,value:n}):this.$emit("removeOne",{key:this.curation.object.key,value:n})},saveSelection:function(){this.$parent.pendingSave=[this.curation.object.key],this.$emitter.emit("ensureLogin")},toggle:function(){this.expanded=!this.expanded}}),beforeMount:function(){null==this.status&&(null==this.curation.matching.match?this.status="unknown":1==this.curation.matching.match?this.status="yes":0==this.curation.matching.match&&(this.status="no")),this.saved_status=this.status},watch:{status_save_all:function(){this.saved_status=this.status}}},h=d,_=(n("8c85"),n("2877")),m=Object(_["a"])(h,r,l,!1,null,"13e425ba",null),p=m.exports,g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tbody",[s("tr",[s("td",["Save"==t.save?s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.curation.object.key,expression:"curation.object.key"}],domProps:{value:t.curation.object.key},on:{blur:function(e){return t.loadKey()},input:function(e){e.target.composing||t.$set(t.curation.object,"key",e.target.value)}}}),t.empty_link?s("a",{attrs:{href:t.empty_link,target:"_blank"}},[s("img",{staticClass:"mini",attrs:{src:n("3952")}})]):t._e()]):t._e(),"Save"!=t.save?s("span",[t.empty_link?s("a",{attrs:{href:t.empty_link,target:"_blank"}},[t._v(t._s(t.curation.object.key))]):s("span",[t._v(t._s(t.curation.object.key))])]):t._e(),t.warning?s("span",{staticClass:"warning"},[s("br"),t._v(t._s(t.warning))]):t._e()]),s("td",{staticClass:"cell-color-na"},[t._v("manual")]),0==t.in_progress?t._l(t.curation_characteristics,(function(e){return s("td",{key:e.score+"sp-td-em",staticClass:"cell-color-na"},[t._v(" "+t._s(t.display_content(t.curation.object,e.value))+" ")])})):t._l(t.curation_characteristics,(function(e){return s("td",{key:e.score+"sp-td-em",staticClass:"cell-color-na"},[s("PulseLoader",{attrs:{color:t.theme_color.main,size:"5px"}})],1)})),s("td",[t.show_button?s("input",{attrs:{type:"checkbox"},domProps:{checked:t.is_yes_selected},on:{click:function(e){return t.changeSelection(e,"yes")}}}):t._e()]),s("td",[t.show_button?s("input",{attrs:{type:"checkbox"},domProps:{checked:t.is_no_selected},on:{click:function(e){return t.changeSelection(e,"no")}}}):t._e()]),s("td",[t.show_button?s("button",{attrs:{disabled:t.to_disable},on:{click:function(e){return t.saveSelection()}}},[t._v(t._s(t.save))]):t._e()]),s("td",[t.curation.object.verbatimLabel?s("button",{staticClass:"button-table",on:{click:function(e){t.expanded=!t.expanded}}},[t.expanded?t._e():s("img",{staticClass:"mini",attrs:{src:n("28b9")}}),t.expanded?s("img",{staticClass:"mini",attrs:{src:n("043b")}}):t._e()]):t._e()])],2),t.expanded?s("tr",{staticClass:"expanded"},[s("td"),s("td",{staticClass:"cell-color-na",attrs:{colspan:t.curation_characteristics.length+1}},[t._v(" "+t._s(t.curation.object.verbatimLabel)+" ")]),s("td",{attrs:{colspan:"4"}})]):t._e()])},f=[],v=(n("e9c4"),n("8a5d").default),b={name:"CurationElement",components:{PulseLoader:v},props:{curation:{type:Object,required:!0},save:{type:String,default:"Save"}},data:function(){return{warning:null,key:"",status:null,saved_status:null,expanded:!1,in_progress:!1}},computed:Object(c["a"])(Object(c["a"])({},Object(o["c"])(["theme_color","urls","curation_characteristics","fields","format_selection","occurrences_selection"])),{},{cssVars:function(){return{"--color":this.theme_color.main}},get_occurrence_name:function(){return this.fields[this.format_selection].format_occurrence.name},get_curation_name:function(){return this.fields[this.format_selection].format_curation.name},is_yes_selected:function(){return"yes"==this.status},is_no_selected:function(){return"no"==this.status},show_button:function(){return null==this.warning&&""!=this.curation.object.key},empty_link:function(){return/^http/.test(this.curation.object.key)?this.curation.object.key:/^\d+$/.test(this.curation.object.key)?"https://www.gbif.org/occurrence/"+this.curation.object.key:null},to_disable:function(){return this.saved_status==this.status}}),methods:{normalizeValue:function(t){return null==t?"NA":t},display_content:function(t,e){for(var n="",s=0;s<e.length;s++)e[s]in t&&(n.length>0&&(n+="/"),n+=t[e[s]]);return n},changeSelection:function(t,e){"yes"==e?(1==t.target.checked&&(this.status="yes"),0==t.target.checked&&(this.status="unknown")):"no"==e&&(1==t.target.checked&&(this.status="no"),0==t.target.checked&&(this.status="unknown"));var n=null;"yes"==this.status&&(n=!0),"no"==this.status&&(n=!1),this.status!=this.saved_status?this.$emit("addOne",{key:this.curation.empty_key,value:n}):this.$emit("removeOne",{key:this.curation.empty_key,value:n})},saveSelection:function(){var t=this,e=null;if("yes"==this.status&&(e=!0),"no"==this.status&&(e=!1),/^\d+$/.test(this.curation.object.key)){var n={occurrenceKey1:this.occurrences_selection.key,occurrenceKey2:parseInt(this.curation.object.key),decision:e},s={occurrenceRelations:[n]};alert(this.urls.matching),alert(JSON.stringify(s)),this.$backend.post_matching(s).then((function(n){alert(JSON.stringify(n)),t.curation.matching.match=e,t.saved_status=t.status,t.$emit("removeOne",{key:t.curation.empty_key,value:e})})).catch((function(t){alert("Failed to save"+t)}))}else this.curation.matching.match=e,this.saved_status=this.status,this.$emit("removeOne",{key:this.curation.empty_key,value:e})},loadKey:function(){this.warning=null;for(var t=0;t<this.occurrences_selection.relations.length;t++)if(this.curation.object.key==this.occurrences_selection.relations[t].object.key){this.warning="already in suggested "+this.get_curation_name.toLowerCase()+"s";break}""!=this.curation.object.key&&/^\d+$/.test(this.curation.object.key)?this.loadGBIF():this.curation.object={key:this.curation.object.key},this.status="yes"},loadGBIF:function(){var t=this;this.in_progress=!0,this.$backend.fetch_occurrence(this.curation.object.key,!0).then((function(e){if("occurrences"in e.data&&t.curation.object.key in e.data.occurrences){var n=t.curation.object.key;t.curation.object=e.data.occurrences[t.curation.object.key],t.curation.object["key"]=n}else t.curation.object={key:t.curation.object.key};t.in_progress=!1})).catch((function(e){t.curation.object={key:t.curation.object.key,error:e},t.warning="unknown GBIF key"}))}},beforeMount:function(){null==this.status&&(null==this.curation.matching.match?this.status="unknown":1==this.curation.matching.match?this.status="yes":0==this.curation.matching.match&&(this.status="no")),this.saved_status=this.status}},y=b,k=(n("6b89"),Object(_["a"])(y,g,f,!1,null,"b2e3d88a",null)),E=k.exports,A={name:"CurationList",mixins:[u["a"].mixin_fields],components:{CurationElement:p,EmptyElement:E},props:{show_back_button:{type:Boolean,required:!1,default:!0}},data:function(){return{empty_elements:[],change_list:[],change_dict:{},status_save_all:0,sort:{by:"$global",asc:!1},show_edit:!1,expanded:!1,pendingSave:[]}},computed:Object(c["a"])(Object(c["a"])({},Object(o["c"])(["urls","theme_color","institution_selection","datasets_selection","occurrences_selection","matching","curation_characteristics","format_selection","fields","user"])),{},{cssVars:function(){return{"--color":this.theme_color.main,"--color-secondary":this.theme_color.secondary}},get_occurrence_name:function(){var t=this.fields[this.format_selection].format_occurrence.name;return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()},get_curation_name:function(){return this.fields[this.format_selection].format_curation.name},processed_curation:function(){var t=this,e=this.occurrences_selection.relations,n=function(e){var n=t.$scoring.get_scores(t.occurrences_selection,e.object),s=n[t.sort.by];return null!=s?parseFloat(s):-1};return this.sort.asc?e.sort((function(t,e){return n(t)-n(e)})):e.sort((function(t,e){return n(e)-n(t)})),e=e.filter((function(t){return null==t.matching.match})),e},finished_curation:function(){var t=this.occurrences_selection.relations;return t=t.filter((function(t){return null!=t.matching.match})),t},processed_empty_elements:function(){var t=this.empty_elements;return t=t.filter((function(t){return null==t.matching.match})),t},finished_empty_elements:function(){var t=this.empty_elements;return t=t.filter((function(t){return null!=t.matching.match})),t},to_disable:function(){return!(Object.keys(this.change_list).length>0)}}),methods:Object(c["a"])(Object(c["a"])({},Object(o["b"])(["updateOccurrencesSelection","updateMatching","updateStep","updateUsername"])),{},{get_scores:function(t,e){return null==t||null==e?{$global:null}:this.$scoring.get_scores(t,e)},removeElement:function(t){var e=this.change_list.indexOf(t.key);e>-1&&this.change_list.splice(e,1)},addElement:function(t){this.change_list.includes(t.key)||this.change_list.push(t.key),this.change_dict[t.key]=t.value},saveName:function(){var t=prompt("Please enter your name or ORCID","");""==t?this.saveName():null==t?alert("Your work is not saved"):this.updateUsername(t)},save:function(){for(var t=[],e=0;e<this.change_list.length;e++)/^\d+$/.test(this.change_list[e])&&t.push(this.change_list[e]);this.pendingSave=t,this.$emitter.emit("ensureLogin")},back:function(){var t=0==this.change_list.length||confirm("Are you sure you want to leaving without saving?");t&&(this.updateOccurrencesSelection(null),this.$emit("clicked"),this.$gtag.event("back"))},sortBy:function(t){t==this.sort.by?this.sort.asc=!this.sort.asc:(this.sort.by=t,this.sort.asc=!1)},addLine:function(){var t={object:{}};t.object.key="",t.empty_key="emptykey_"+this.empty_elements.length,t.matching={},t.matching.match=null,this.empty_elements.push(t),this.addElement({key:t.empty_key,value:!0})},saveToSibBackend:function(t){var e,n={},s=Object(a["a"])(this.occurrences_selection.relations);try{for(s.s();!(e=s.n()).done;){var i=e.value;n[i.object.key]={occurrence:Object(c["a"])({},i.object),decision:i.matching.match,is_new_decision:!1},delete n[i.object.key].occurrence.relations}}catch(l){s.e(l)}finally{s.f()}for(var o=0;o<t.length;o++)n[t[o]].decision=this.change_dict[this.change_list[o]],n[t[o]].is_new_decision=!0;var r={institutionKey:this.institution_selection.key,datasetKey:this.datasets_selection[0],user:{name:this.user.name,orcid:this.user.orcid},refOccurrence:Object(c["a"])({},this.occurrences_selection),relations:Object.values(n)};delete r.refOccurrence.relations,this.$backend.post_sib_matching(r).then((function(){})).catch((function(){}))},saveToPlaziBackend:function(t){for(var e=this,n=[],s=0;s<t.length;s++){var i={occurrenceKey1:this.occurrences_selection.key,occurrenceKey2:t[s],decision:this.change_dict[this.change_list[s]],userName:this.user.name,orcid:this.user.orcid};n.push(i)}var a={occurrenceRelations:n};this.$backend.post_matching(a).then((function(){for(var t=0;t<e.occurrences_selection.relations.length;t++)e.change_list.includes(e.occurrences_selection.relations[t].object.key)&&(e.occurrences_selection.relations[t].matching.match=e.change_dict[e.occurrences_selection.relations[t].object.key]);for(var n=0;n<e.empty_elements.length;n++)e.change_list.includes(e.empty_elements[n].empty_key)&&(e.empty_elements[n].matching.match=e.change_dict[e.empty_elements[n].empty_key]);e.change_list=[],e.change_dict={},e.status_save_all+=1})).catch((function(t){alert("Failed to save"+t)}))}}),mounted:function(){var t=this;this.$emitter.on("logged",(function(){if(t.pendingSave.length>0){var e=t.pendingSave.slice();t.pendingSave=[],t.saveToSibBackend(e),t.saveToPlaziBackend(e),t.$gtag.event("save")}})),this.$emitter.on("loginAbort",(function(){t.pendingSave&&(t.pendingSave=[],alert("Your work is not saved"))}))}},O=A,C=(n("ca96"),n("18eb"),Object(_["a"])(O,s,i,!1,null,"5f522213",null));e["a"]=C.exports},"5a34":function(t,e,n){var s=n("da84"),i=n("44e7"),a=s.TypeError;t.exports=function(t){if(i(t))throw a("The method doesn't accept regular expressions");return t}},"671b":function(t,e,n){"use strict";n("73af")},6927:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJEAAACRCAYAAADD2FojAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAXEgAAFxIBZ5/SUgAABAVJREFUeAHtne1pG0EURTNCfdjpJJ0kqSTqJE4nKUWpZDOC/BBGCmNYuB97BAZ5Pey7756DJds/PC7z8YkHDaw18DqPXe+P3vwZ8+O6bdvL/Rd4TgOrDYwxPp9WD3OOBp41gETPmuH6cgNItFwVB581cOL90LNquL7awGm+MfqzephzNPCoAV7OHrXCtQ81gEQfqovDjxo4P7r4/tp8yfs1r13fX+fz7gbm++UfKxsuSTRvdPvF5HXlhpzpaWAy/7bygxcvZz3MZZsgkaz6nsFI1MNStgkSyarvGYxEPSxlmyCRrPqewUjUw1K2CRLJqu8ZjEQ9LGWbIJGs+p7BSNTDUrYJEsmq7xmMRD0sZZsgkaz6nsFI1MNStgkSyarvGYxEPSxlmyCRrPqewUjUw1K2CRLJqu8ZjEQ9LGWbIJGs+p7BSNTDUrYJEsmq7xmMRD0sZZsgkaz6nsFI1MNStgkSyarvGYxEPSxlmyCRrPqewUjUw1K2CRLJqu8ZjEQ9LGWbIJGs+p7BSNTDUrYJEsmq7xmMRD0sZZsgkaz6nsFI1MNStgkSyarvGYxEPSxlmyCRrPqewUjUw1K2CRLJqu8ZjEQ9LGWbIJGs+p7BSNTDUrYJEsmq7xmMRD0sZZsgkaz6nsFI1MNStgkSyarvGYxEPSxlmyCRrPqewUjUw1K2yVk1+d//XP+pmt80d4zxffb5ptqJ70Sq5ovmIlERTNUqSKRqvmguEhXBVK2CRKrmi+YiURFM1SpIpGq+aC4SFcFUrYJEquaL5iJREUzVKkikar5orvJvZ2+zx9sHj/AG+E4UDtAhPhI5UAjPgEThAB3iI5EDhfAMSBQO0CE+EjlQCM+AROEAHeIjkQOF8AxIFA7QIT4SOVAIz4BE4QAd4iORA4XwDEgUDtAhPhI5UAjPgEThAB3iI5EDhfAMSBQO0CE+EjlQCM+AROEAHeIjkQOF8AxIFA7QIT4SOVAIz4BE4QAd4iORA4XwDEgUDtAhPhI5UAjPgEThAB3iI5EDhfAMSBQO0CE+EjlQCM+AROEAHeIjkQOF8AxIFA7QIT4SOVAIz4BE4QAd4iORA4XwDEgUDtAhPhI5UAjPgEThAB3iI5EDhfAMSBQO0CE+EjlQCM+AROEAHeIjkQOF8AxIFA7QIT4SOVAIz4BE4QAd4iORA4XwDEgUDtAhPhI5UAjPgEThAB3iI5EDhfAMSBQO0CE+EjlQCM+AROEAHeIjkQOF8AznxfyX+bgunuVYSQPbtr2srLIk0bzZ15WbceaYDfBydkzuu26NRLvWecybIdExue+6NRLtWucxb4ZEx+S+69ZItGudx7wZEh2T+65b335PdBljvN7d9ct8/vvuc57SwH8b+AspFDJmv8EizgAAAABJRU5ErkJggg=="},"6b89":function(t,e,n){"use strict";n("e9cb")},"6c55":function(t,e,n){"use strict";n("91cd")},"73af":function(t,e,n){},"8a5d":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"v-spinner"},[n("div",{staticClass:"v-pulse v-pulse1",style:[t.spinnerStyle,t.spinnerDelay1]}),n("div",{staticClass:"v-pulse v-pulse2",style:[t.spinnerStyle,t.spinnerDelay2]}),n("div",{staticClass:"v-pulse v-pulse3",style:[t.spinnerStyle,t.spinnerDelay3]})])},i=[],a={name:"PulseLoader",props:{loading:{type:Boolean,default:!0},color:{type:String,default:"#5dc596"},size:{type:String,default:"15px"},margin:{type:String,default:"2px"},radius:{type:String,default:"100%"}},data:function(){return{spinnerStyle:{backgroundColor:this.color,width:this.size,height:this.size,margin:this.margin,borderRadius:this.radius,display:"inline-block",animationName:"v-pulseStretchDelay",animationDuration:"0.75s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.2,.68,.18,1.08)",animationFillMode:"both"},spinnerDelay1:{animationDelay:"0.12s"},spinnerDelay2:{animationDelay:"0.24s"},spinnerDelay3:{animationDelay:"0.36s"}}}},c=a,o=(n("671b"),n("2877")),r=Object(o["a"])(c,s,i,!1,null,null,null);e["default"]=r.exports},"8c85":function(t,e,n){"use strict";n("bce1")},"91cd":function(t,e,n){},a434:function(t,e,n){"use strict";var s=n("23e7"),i=n("da84"),a=n("23cb"),c=n("5926"),o=n("07fa"),r=n("7b0b"),l=n("65f0"),u=n("8418"),d=n("1dde"),h=d("splice"),_=i.TypeError,m=Math.max,p=Math.min,g=9007199254740991,f="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!h},{splice:function(t,e){var n,s,i,d,h,v,b=r(this),y=o(b),k=a(t,y),E=arguments.length;if(0===E?n=s=0:1===E?(n=0,s=y-k):(n=E-2,s=p(m(c(e),0),y-k)),y+n-s>g)throw _(f);for(i=l(b,s),d=0;d<s;d++)h=k+d,h in b&&u(i,d,b[h]);if(i.length=s,n<s){for(d=k;d<y-s;d++)h=d+s,v=d+n,h in b?b[v]=b[h]:delete b[v];for(d=y;d>y-s+n;d--)delete b[d-1]}else if(n>s)for(d=y-s;d>k;d--)h=d+s-1,v=d+n-1,h in b?b[v]=b[h]:delete b[v];for(d=0;d<n;d++)b[d+k]=arguments[d+2];return b.length=y-s+n,i}})},ab13:function(t,e,n){var s=n("b622"),i=s("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,"/./"[t](e)}catch(s){}}return!1}},bce1:function(t,e,n){},beea:function(t,e,n){},c5a5:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJEAAACRCAYAAADD2FojAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAXEgAAFxIBZ5/SUgAABHRJREFUeAHtnYFtGkEQRQNKH3Y6SScklUAncTpxOiGVXPYkpEE2l90bzWjR/IdkaX23O8u8/wTYxsfh0m5fuEFgjMBrm3a9n7r6c2hf12VZXu5PMIbAKIHD4fDtODqZeRDYIoBEW2Q4PkwAiYZRMXGLwJHXQ1toOD5K4NheGP0dncw8CDwiwNPZIyoc20UAiXbhYvIjAl8fHfx4rD3l/W7Hrh+P831tAu318nmkwyGJWqH1F5PXkYLMqUOgZf5j5Acvns7qZD6tEySahr7OxkhUJ8tpnSDRNPR1NkaiOllO6wSJpqGvszES1clyWidINA19nY2RqE6W0zpBomno62yMRHWynNYJEk1DX2djJKqT5bROkGga+jobI1GdLKd1gkTT0NfZGInqZDmtEySahr7OxkhUJ8tpnSDRNPR1Nh59o36djjc6ub0p/dfG6U+H1/+AWdd8OiF4gEciwdCjW0aiaKKC9ZBIMPTolpEomqhgPSQSDD26ZSSKJipYD4kEQ49uGYmiiQrWQyLB0KNbRqJoooL1kEgw9OiWkSiaqGA9JBIMPbplJIomKlgPiQRDj24ZiaKJCtZDIsHQo1tGomiigvWQSDD06JaRKJqoYD0kEgw9umUkiiYqWA+JBEOPbhmJookK1kMiwdCjW0aiaKKC9ZBIMPTolpEomqhgPSQSDD26ZSSKJipYD4kEQ49uGYmiiQrWQyLB0KNbRqJoooL1pl1ub+/l7bKzaZ//vmuLNv90Pp9PuxYlTW6X/vvZeL4lle+W5ZGoi4gJPQJI1CPE+S4BJOoiYkKPABL1CHG+SwCJuoiY0COARD1CnO8SQKIuIib0CCBRjxDnuwSQqIuICT0CSNQjxPkuASTqImJCj8DMv529tTu3fj3Fbe/f8vioKouNRyJjwchJAImc4FhmBJDIWDByEkAiJziWGQEkMhaMnASQyAmOZUYAiYwFIycBJHKCY5kRQCJjwchJAImc4FhmBJDIWDByEkAiJziWGQEkMhaMnASQyAmOZUYAiYwFIycBJHKCY5kRQCJjwchJAImc4FhmBJDIWDByEkAiJziWGQEkMhaMnASQyAmOZUYAiYwFIycBJHKCY5kRQCJjwchJAImc4FhmBJDIWDByEkAiJziWGQEkMhaMnASQyAmOZUYAiYwFIycBJHKCY5kRQCJjwchJAImc4FhmBKZdbs/uwvOM2iX0/uy4N+875paeikS3eG+fF/ZWOu2k5ng6SwKrVBaJlNJO6hWJksAqlUUipbSTekWiJLBKZZFIKe2kXpEoCaxSWSRSSjupVyRKAqtUFomU0k7qFYmSwCqVRSKltJN6RaIksEplkUgp7aRekSgJrFJZJFJKO6lXJEoCq1QWiZTSTuoViZLAKpVFIqW0k3odfaN+ex/75Zp0Hyj7pASWZXkZuWtDErVip5FizNEkwNOZZu6hXSNRKE7NYkikmXto10gUilOzGBJp5h7aNRKF4tQshkSauYd2vf6e6NIuqfJ6V/V7G7/ffc8QAv8l8A/RFE7lrzgAJAAAAABJRU5ErkJggg=="},ca96:function(t,e,n){"use strict";n("396c")},caad:function(t,e,n){"use strict";var s=n("23e7"),i=n("4d64").includes,a=n("44d2");s({target:"Array",proto:!0},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),a("includes")},dd27:function(t,e,n){t.exports=n.p+"img/logo_ebiodiv_small.2a380f8c.png"},e3eb:function(t,e,n){},e9cb:function(t,e,n){},eb5f:function(t,e,n){"use strict";var s=n("2909"),i=(n("2af1"),n("4de4"),n("d3b7"),n("a15b"),n("d81d"),{PRESERVED_SPECIMEN:"Specimen",FOSSIL_SPECIMEN:"Fossil",LIVING_SPECIMEN:"Living Specimen",OBSERVATION:"Observation",HUMAN_OBSERVATION:"Human Observation",MACHINE_OBSERVATION:"Machine Observation",LITERATURE:"Literature Occurrence",MATERIAL_SAMPLE:"Material sample",OCCURRENCE:"Occurrence evidence",MATERIAL_CITATION:"Material citation",UNKNOWN:"Unknown evidence"}),a={TYPE:"Type",TYPE_SPECIES:"Type species",TYPE_GENUS:"Type genus",ALLOLECTOTYPE:"Allolectotype",ALLONEOTYPE:"Alloneotype",ALLOTYPE:"Allotype",COTYPE:"Cotype",EPITYPE:"Epitype",EXEPITYPE:"Ex-epitype",EXHOLOTYPE:"Ex-holotype",EXISOTYPE:"Ex-isotype",EXLECTOTYPE:"Ex-lectotype",EXNEOTYPE:"Ex-neotype",EXPARATYPE:"Ex-paratype",EXSYNTYPE:"Ex-syntype",EXTYPE:"Ex-type",HAPANTOTYPE:"Hapantotype",HOLOTYPE:"Holotype",ICONOTYPE:"Iconotype",ISOLECTOTYPE:"Isolectotype",ISONEOTYPE:"Isoneotype",ISOSYNTYPE:"Isosyntype",ISOTYPE:"Isotype",LECTOTYPE:"Lectotype",NEOTYPE:"Neotype",PARALECTOTYPE:"Paralectotype",PARANEOTYPE:"Paraneotype",PARATYPE:"Paratype",PLASTOHOLOTYPE:"Plastoholotype",PLASTOISOTYPE:"Plastoisotype",PLASTOLECTOTYPE:"Plastolectotype",PLASTONEOTYPE:"Plastoneotype",PLASTOPARATYPE:"Plastoparatype",PLASTOSYNTYPE:"Plastosyntype",PLASTOTYPE:"Plastotype",SECONDARYTYPE:"Secondary type",SUPPLEMENTARYTYPE:"Supplementary type",SYNTYPE:"Syntype",TOPOTYPE:"Topotype",ORIGINALMATERIAL:"Original material",NOTATYPE:"Not a type"},c=new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:3,maximumFractionDigits:3});e["a"]={mixin_fields:{methods:{display_value_decimalLatitude_decimalLongitude:function(t,e){if(null!=t&null!=e){var n=["S","","N"][1+Math.sign(t)],s=["W","","E"][1+Math.sign(e)];return c.format(t)+n+", "+c.format(e)+s}return null!=t&&null!=e||null==t&&null==e?"":t+", "+e},display_value_elevation_depth:function(t,e){return null!=t&&null==e?t:null==t&&null!=e?-e:null!=t&&null!=e?t+"/"+-e:""},display_value_day_month_year:function(t,e,n){var s=[t,e,n].filter((function(t){return null!=t}));return s.join("/")},display_value_typeStatus:function(t){var e=a[t];return null!=e?e:t},display_value_basisOfRecord:function(t){var e=i[t];return null!=e?e:t},display_content:function(t,e){var n=e.map((function(e){return t[e]})),i="display_value_"+e.join("_");return i in this?this[i].apply(this,Object(s["a"])(n)):n.filter((function(t){return null!=t})).join("/")}}}}},f748:function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}}}]);
//# sourceMappingURL=home~occurrence~occurrenceList.095a28ed.js.map
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["home~occurrence~occurrenceList"],{"0177":function(e,t,n){"use strict";n("8d8a")},"0303":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:e.bannerCssClasses,style:e.cssVars},[i("div",[i("div",{staticClass:"float-start position-absolute"},[i("a",{attrs:{href:e.baseUrl}},[i("img",{staticClass:"medium-img",attrs:{src:n("dd27")}})])]),i("h1",[e._v(e._s(e.title))]),i("p",[i("i",[e._v(e._s(e.subtitle))])])]),i("div",{staticClass:"user-login-container"},[i("b-nav",[i("b-nav-item",{attrs:{href:"https://ebiodiv.org/help/","link-classes":"ebiodiv_navbar_link",target:"_blank"}},[i("b-icon-question-circle"),e._v(" Help")],1),i("b-nav-item",{attrs:{href:"https://ebiodiv.org/","link-classes":"ebiodiv_navbar_link",target:"_blank"}},[i("b-icon-info-circle"),e._v(" About")],1)],1),i("UserComponent")],1)])},r=[],c=n("5530"),s=(n("ac1f"),n("5319"),n("2f62")),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-login"},[e.user.name?[n("div",{attrs:{id:"loginName"}},[n("b-icon",{attrs:{icon:"person-fill"}}),e._v(" "+e._s(e.user.name))],1),n("b-popover",{attrs:{target:"loginName",triggers:"hover",placement:"bottomright",delay:{show:50,hide:400}}},[n("b-container",[n("b-row",{staticClass:"mb-2 mt-2"},[n("b-col",[e._v("ORCID "),n("a",{attrs:{href:e.userOrcidUrl,target:"_blank"}},[e._v(e._s(e.user.orcid))])])],1),n("b-row",{staticClass:"mb-2 mt-2"},[n("b-col",[n("b-button",{attrs:{variant:"outline-danger",size:"sm"},on:{click:e.logout}},[e._v("Log out")])],1)],1)],1)],1)]:[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"loginForm",expression:"'loginForm'"}],attrs:{size:"sm",id:"loginName"}},[n("b-icon",{attrs:{icon:"person-fill"}}),e._v(" Login")],1),n("b-modal",{attrs:{id:"loginForm",title:"Login with your ORCID","hide-footer":!0},on:{show:e.onLoginShow,hide:e.onLoginHide}},[n("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-body mx-auto"},[n("div",[n("a",{staticClass:"btn btn-outline-primary",attrs:{id:"oauthLink",href:e.authUrl,role:"button",target:"_blank",rel:"opener"},on:{click:e.startOAuth}},[n("img",{attrs:{src:"orcid_24x24.webp"}}),e._v(" Connect your ORCID")])])])])])])]],2)},a=[],u=n("1da1"),l=(n("b0c0"),n("96cf"),{name:"UserComponent",data:function(){return{authUrl:null,pendingLogin:!1}},computed:Object(c["a"])(Object(c["a"])({},Object(s["c"])(["user"])),{},{userOrcidUrl:function(){return null!=this.$orcid.config?this.$orcid.config.issuer+"/"+this.user.orcid:"https://orcid.org/"+this.user.orcid}}),methods:Object(c["a"])(Object(c["a"])({},Object(s["b"])(["updateOrcidUser"])),{},{onLoginShow:function(){this.pendingLogin=!0},onLoginHide:function(){this.pendingLogin&&this.$emitter.emit("loginAbort"),this.pendingLogin=!1},startOAuth:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:window.setOrcidToken=function(t){e.updateOrcidUser(t),window.setOrcidToken=null,e.$emitter.emit("logged")};case 1:case"end":return t.stop()}}),t)})))()},logout:function(){this.$emitter.emit("logout"),this.updateOrcidUser({name:null,orcid:null,orcidToken:null})}}),mounted:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$orcid.getAuthUrl();case 2:e.authUrl=t.sent,e.$emitter.on("logged",(function(){e.pendingLogin=!1})),e.$emitter.on("ensureLogin",(function(){e.user.name?e.$emitter.emit("logged"):e.$bvModal.show("loginForm")}));case 5:case"end":return t.stop()}}),t)})))()}}),d=l,h=(n("286e"),n("2877")),m=Object(h["a"])(d,o,a,!1,null,"e3031a88",null),_=m.exports,p={name:"BannerComponent",components:{UserComponent:_},props:{title:{type:String,required:!0},subtitle:{type:String,required:!0,default:""}},computed:Object(c["a"])(Object(c["a"])({},Object(s["c"])(["theme_color"])),{},{cssVars:function(){return{"--color-main":this.theme_color.main,"--color-secondary":this.theme_color.secondary}},bannerCssClasses:function(){return"banner "+"backend-sandbox.json".replace(".json","").replace("backend-","")+"Backend"},baseUrl:function(){var e="";return""==e?"/":e}})},g=p,f=(n("fde8"),Object(h["a"])(g,i,r,!1,null,"54254476",null));t["a"]=f.exports},"043b":function(e,t,n){e.exports=n.p+"img/icon_reduce.72cce8bc.png"},"04d1":function(e,t,n){var i=n("342f"),r=i.match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},"07ac":function(e,t,n){var i=n("23e7"),r=n("6f53").values;i({target:"Object",stat:!0},{values:function(e){return r(e)}})},1039:function(e,t,n){"use strict";n("34da")},"286e":function(e,t,n){"use strict";n("beea")},"28b9":function(e,t,n){e.exports=n.p+"img/icon_expand.01503fbf.png"},"2af1":function(e,t,n){var i=n("23e7"),r=n("f748");i({target:"Math",stat:!0},{sign:r})},"2d96":function(e,t,n){e.exports=n.p+"img/icon_close.0cd9cdfd.png"},"34da":function(e,t,n){},"396c":function(e,t,n){},"3f00":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"component-container",style:e.cssVars},[e.in_progress?i("div",{staticClass:"centered-container"},[i("PulseLoader",{attrs:{color:e.theme_color.main}})],1):e._e(),e.in_progress?e._e():i("table",[i("tr",{staticClass:"empty-line"},[i("td",{attrs:{colspan:"100"}},[i("div",{staticClass:"separator"},[i("h2",[i("span",[e._v(e._s(e.get_occurrence_name)+" "+e._s(e.user_query.occurrence_key)+" "+e._s(e.get_description))])])])])]),i("tr",[i("th",[e._v("Key")]),i("th"),e._l(e.curation_characteristics,(function(t){return i("th",{key:t.score+"main-th"},[e._v(e._s(t.name))])})),i("th",{attrs:{colspan:"2"}}),i("th")],2),i("tr",{staticClass:"reference-entity"},[i("td",[i("a",{attrs:{href:"https://www.gbif.org/occurrence/"+e.user_query.occurrence_key,target:"_blank"}},[e._v(e._s(e.user_query.occurrence_key))])]),i("td"),e._l(e.curation_characteristics,(function(t){return[t.value?i("td",{key:t.score+"main-td",class:"cell_"+t.score},[e._v(e._s(e.display_content(e.get_occurrence,t.value)))]):e._e()]})),i("td",{attrs:{colspan:"2"}}),i("td",["MATERIAL_CITATION"==e.user_query.basisOfRecord?i("button",{staticClass:"button-table",on:{click:function(t){e.expanded=!e.expanded}}},[e.expanded?e._e():i("img",{staticClass:"mini",attrs:{src:n("28b9")}}),e.expanded?i("img",{staticClass:"mini",attrs:{src:n("043b")}}):e._e()]):e._e()])],2),e.expanded?i("tr",{staticClass:"expanded"},[i("td",{attrs:{colspan:"100"}},[e.get_occurrence.verbatimLabel?i("div",{staticClass:"expanded-box"},[e._v(" "+e._s(e.get_occurrence.verbatimLabel)+" ")]):e._e(),"references"in e.get_occurrence?i("div",{staticClass:"expanded-box"},[i("label",[e._v("Data source:")]),i("ul",[i("li",[i("a",{attrs:{href:e.get_occurrence.references,target:"_blank"}},[e._v("Treatment")])]),"identifier"in e.get_occurrence?i("li",[i("a",{attrs:{href:e.get_mc,target:"_blank"}},[e._v("Material citation")])]):e._e()])]):e._e()])]):e._e(),i("tr",{staticClass:"empty-line"},[i("td",{attrs:{colspan:"100"}},[i("br"),i("br"),i("div",{staticClass:"separator"},[i("h2",[i("span",[e._v(e._s(e.get_curation_name)+"s associated with the "+e._s(e.get_occurrence_name.toLowerCase())+" "+e._s(e.user_query.occurrence_key))])])]),i("p",[e._v(" "+e._s(e.to_process_curation.length)+" suggested "+e._s(e.get_curation_name.toLowerCase())+e._s(e.to_process_curation.length>1?"s":"")+" to curate ")]),i("p",{staticClass:"notice"},[e._v("Please indicate for each suggested "+e._s(e.get_curation_name.toLowerCase())+" whether it matches the "+e._s(e.get_occurrence_name.toLowerCase())+" or not (Yes / No).")])])]),e.to_process_curation.length>0?i("tr",[i("th",[e._v("Key")]),i("th",{on:{click:function(t){return e.sortBy("$global")}}},[e._v("Score")]),e._l(e.curation_characteristics,(function(t){return i("th",{key:t.score+"sp-th",staticClass:"clickable-th",on:{click:function(n){return e.sortBy(t.score)}}},[e._v(e._s(t.name))])})),i("th",[e._v("Decision")]),i("th",[e._v("Comment")]),i("th")],2):e._e(),e._l(e.to_process_curation,(function(t){return i("CurationElement",{key:t.occurrenceKey2,attrs:{occurrence:e.occurrences[t.occurrenceKey2],matching:t,scores:e.get_scores(e.occurrences[e.user_query.occurrence_key],e.occurrences[t.occurrenceKey2])},on:{updateCuration:e.updateCuration}})})),e.finished_curation.length>0||e.finished_empty_elements.length>0?i("tr",{staticClass:"empty-line"},[i("td",{attrs:{colspan:"100"}},[i("br"),i("br"),i("img",{directives:[{name:"show",rawName:"v-show",value:!e.show_edit,expression:"!show_edit"}],staticClass:"mini",attrs:{src:n("c5a5"),alt:"[+]"},on:{click:function(t){e.show_edit=!e.show_edit}}}),i("img",{directives:[{name:"show",rawName:"v-show",value:e.show_edit,expression:"show_edit"}],staticClass:"mini",attrs:{src:n("6927"),alt:"[-]"},on:{click:function(t){e.show_edit=!e.show_edit}}}),e._v(" "+e._s(e.finished_curation.length+e.finished_empty_elements.length)+" "+e._s(e.get_curation_name.toLowerCase())),e.finished_curation.length+e.finished_empty_elements.length>1?i("span",[e._v("s")]):e._e(),e._v(" already curated ")])]):e._e(),e.show_edit&&(e.finished_curation.length>0||e.finished_empty_elements.length>0)?i("tr",[i("th",[e._v("Key")]),i("th",[e._v("Score")]),e._l(e.curation_characteristics,(function(t){return i("th",{key:t.score+"sp-th",staticClass:"clickable-th"},[e._v(e._s(t.name))])})),i("th",[e._v("Decision")]),i("th",[e._v("Comment")]),i("th")],2):e._e(),e.show_edit&&e.finished_curation.length>0?e._l(e.finished_curation,(function(t){return i("CurationElement",{key:t.occurrenceKey2,attrs:{occurrence:e.occurrences[t.occurrenceKey2],matching:t,scores:e.get_scores(e.occurrences[e.user_query.occurrence_key],e.occurrences[t.occurrenceKey2])},on:{updateCuration:e.updateCuration}})})):e._e()],2),e.in_progress?e._e():i("div",[i("div",{staticClass:"button-container"},[e.show_back_button?i("button",{on:{click:function(t){return e.nosaveBack()}}},[e._v("Go back to list")]):e._e(),i("button",{on:{click:function(t){return e.nosaveNext()}}},[e._v("Continue")]),i("br"),i("br"),i("button",{directives:[{name:"show",rawName:"v-show",value:e.changes>0,expression:"changes > 0"}],on:{click:function(t){return e.saveBack()}}},[e._v("Save and Go back to list")]),i("button",{directives:[{name:"show",rawName:"v-show",value:e.changes>0,expression:"changes > 0"}],on:{click:function(t){return e.saveNext()}}},[e._v("Save and Continue")])]),e._m(0)])])},r=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"left-container"},[n("h3",[e._v("Color legend for the matching score")]),n("table",{staticClass:"legend-table"},[n("tr",[n("td",[n("div",{staticClass:"color-box cell-color-1"})]),n("td",[n("div",{staticClass:"color-box cell-color-2"})]),n("td",[n("div",{staticClass:"color-box cell-color-3"})]),n("td",[n("div",{staticClass:"color-box cell-color-4"})]),n("td",[n("div",{staticClass:"color-box cell-color-5"})]),n("td",[n("div",{staticClass:"color-box cell-color-6"})]),n("td",[n("div",{staticClass:"color-box cell-color-7"})]),n("td",[n("div",{staticClass:"color-box cell-color-8"})]),n("td",[n("div",{staticClass:"color-box cell-color-9"})]),n("td",[n("div",{staticClass:"color-box cell-color-10"})]),n("td",[n("div",{staticClass:"color-box cell-color-11"})])]),n("tr",[n("td",[e._v("1")]),n("td",[e._v("0.9")]),n("td",[e._v("0.8")]),n("td",[e._v("0.7")]),n("td",[e._v("0.6")]),n("td",[e._v("0.5")]),n("td",[e._v("0.4")]),n("td",[e._v("0.3")]),n("td",[e._v("0.2")]),n("td",[e._v("0.1")]),n("td",[e._v("0.0")])])]),n("a",{attrs:{href:"/scoring",target:"_blank"}},[e._v("Scoring algorithm")])])}],c=n("b85c"),s=n("3835"),o=n("5530"),a=(n("b0c0"),n("fb6a"),n("ac1f"),n("5319"),n("4fad"),n("4e82"),n("4de4"),n("d3b7"),n("b64b"),n("466d"),n("07ac"),n("2f62")),u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("tbody",[i("tr",[i("td",[i("a",{attrs:{href:"https://www.gbif.org/occurrence/"+e.occurrence.key,target:"_blank"}},[e._v(e._s(e.occurrence.key))])]),i("td",{class:e.cellColor(e.scores.$global)},[e._v(e._s(e.scores.$global))]),e._l(e.curation_characteristics,(function(t){return i("td",{key:t.score+"sp-td",class:"cell_"+t.score+" "+e.cellColor(e.scores[t.score])},[e._v(" "+e._s(e.display_content(e.occurrence,t.value))+" ")])})),i("td",{staticClass:"decision"},[i("input",{attrs:{type:"checkbox"},domProps:{checked:"yes"==e.status},on:{click:function(t){return e.changeSelection(t,"yes")}}}),e._v(" Yes "),i("br"),i("input",{attrs:{type:"checkbox"},domProps:{checked:"no"==e.status},on:{click:function(t){return e.changeSelection(t,"no")}}}),e._v(" No "),i("br"),i("input",{attrs:{type:"checkbox"},domProps:{checked:"undecided"==e.status},on:{click:function(t){return e.changeSelection(t,"undecided")}}}),e._v(" Undecided ")]),i("td",{staticClass:"comment"},[i("CommentElement",{attrs:{occurrence_key:e.matching.occurrenceKey1,curation_key:e.matching.occurrenceKey2}})],1),i("td",[e.occurrence.verbatimLabel?i("button",{staticClass:"button-table",on:{click:function(t){e.expanded=!e.expanded}}},[e.expanded?e._e():i("img",{staticClass:"mini",attrs:{src:n("28b9")}}),e.expanded?i("img",{staticClass:"mini",attrs:{src:n("043b")}}):e._e()]):e._e()])],2),e.expanded?i("tr",{staticClass:"expanded"},[i("td",{attrs:{colspan:"100"}},[e.occurrence.verbatimLabel?i("div",{staticClass:"expanded-box"},[e._v(" "+e._s(e.occurrence.verbatimLabel)+" ")]):e._e(),"references"in e.occurrence?i("div",{staticClass:"expanded-box"},[i("label",[e._v("Data source:")]),i("ul",[i("li",[i("a",{attrs:{href:e.occurrence.references,target:"_blank"}},[e._v("Treatment")])]),"identifier"in e.occurrence?i("li",[i("a",{attrs:{href:e.get_mc,target:"_blank"}},[e._v("Material citation")])]):e._e()])]):e._e()])]):e._e()])},l=[],d=n("eb5f"),h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.in_progress?i("PulseLoader",{attrs:{color:e.theme_color.main}}):e._e(),e.in_progress?e._e():i("div",[i("button",{staticClass:"button-table",on:{click:function(t){return e.openComments()}}},[i("img",{staticClass:"small",attrs:{src:n("d665")}})]),i("br"),e._v(" "+e._s(e.comments.length)+" comment"),e.comments.length>1?i("span",[e._v("s")]):e._e()]),i("div",{class:e.comments_popup},[i("div",{staticClass:"right-container"},[i("button",{staticClass:"close-button",attrs:{type:"button"},on:{click:function(t){return e.closeComments()}}},[i("img",{staticClass:"mini",attrs:{src:n("2d96")}}),e._v(" Close ")])]),i("h1",[e._v("Comments")]),i("div",{ref:"commentsContainer",staticClass:"comments-container"},[e._l(e.comments,(function(t){return i("div",{key:t.id,class:e.comment_class(t.orcid)},[i("label",{attrs:{for:"msg"}},[i("b",{staticClass:"orcid-link",on:{click:function(n){return e.goToOrcid(t.orcid)}}},[e._v(e._s(t.userName))])]),e._v(" wrote on "+e._s(new Date(t.timestamp).toGMTString())+" "),i("p",[e._v(e._s(t.text))])])})),i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.comment,expression:"comment"}],attrs:{placeholder:"Type a comment",name:"msg",required:""},domProps:{value:e.comment},on:{input:function(t){t.target.composing||(e.comment=t.target.value)}}}),i("div",{staticClass:"right-container"},[i("button",{staticClass:"button-validation",attrs:{type:"button",disabled:e.to_disable},on:{click:function(t){return e.postComment()}}},[e._v(" Send ")])])],2)])],1)},m=[],_=(n("a9e3"),n("8a5d").default),p={name:"CommentElement",components:{PulseLoader:_},props:{occurrence_key:{type:Number,required:!0},curation_key:{type:Number,required:!0}},data:function(){return{in_progress:!0,comments:[],comments_visibility:!1,comment:"",pending_post:""}},computed:Object(o["a"])(Object(o["a"])({},Object(a["c"])(["theme_color","user"])),{},{cssVars:function(){return{"--color":this.theme_color.main}},comments_popup:function(){return"comments-popup "+this.comments_visibility},to_disable:function(){return""==this.comment}}),methods:Object(o["a"])(Object(o["a"])({},Object(a["b"])(["updateUsername"])),{},{loadComment:function(){var e=this;this.in_progress=!0,this.comments=[];var t=this.$backend.fetch_comments(this.occurrence_key,this.curation_key);t.then((function(t){e.comments=t.data.results,e.scrollToBottom(),e.in_progress=!1})).catch((function(t){console.log(t),e.in_progress=!1}))},openComments:function(){this.comments_visibility=!0},closeComments:function(){var e=0==this.comment.length||confirm("Are you sure you want to leaving without sending your comment?");e&&(this.comments_visibility=!1,this.comment="")},postComment:function(){this.pending_comment=this.comment,this.$emitter.emit("ensureLogin")},sendComment:function(){var e=this;this.in_progress=!0;var t={occurrenceKey1:this.occurrence_key,occurrenceKey2:this.curation_key,text:this.pending_comment,orcid:this.user.orcid,userName:this.user.name},n=this.$backend.post_comment(t);n.then((function(){e.comment="",e.loadComment()})).catch((function(t){console.log(t),e.in_progress=!1}))},comment_class:function(e){var t="comment-container";return e==this.user.orcid&&(t+=" user"),t},scrollToBottom:function(){var e=this;this.$nextTick((function(){var t=e.$refs.commentsContainer;t.scrollTop=t.scrollHeight}))},goToOrcid:function(e){window.open("http://orcid.org/"+e)}}),beforeMount:function(){this.loadComment()},mounted:function(){var e=this;this.$emitter.on("logged",(function(){""!=e.pending_comment&&(e.sendComment(e.pending_comment),e.pending_comment="",e.$gtag.event("post"))})),this.$emitter.on("loginAbort",(function(){""!=e.pending_comment&&(e.pending_comment="",alert("Your comment is not saved"))}))}},g=p,f=(n("aace"),n("2877")),v=Object(f["a"])(g,h,m,!1,null,"4acd0548",null),b=v.exports,y={name:"CurationElement",mixins:[d["a"].mixin_fields],components:{CommentElement:b},props:{occurrence:{type:Object,required:!0},matching:{type:Object,required:!0},scores:{type:Object,required:!0}},data:function(){return{status:null,expanded:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(a["c"])(["theme_color","curation_characteristics","fields"])),{},{cssVars:function(){return{"--color":this.theme_color.main}},get_mc:function(){return"https://treatment.plazi.org/id/"+this.occurrence.identifier.replace(".mc.","#")}}),methods:{normalizeValue:function(e){return null==e?"NA":e},cellColor:function(e){var t="cell-color-na";return null==e?t="cell-color-na":e>=1?t="cell-color-1":e>=.9?t="cell-color-2":e>=.8?t="cell-color-3":e>=.7?t="cell-color-4":e>=.6?t="cell-color-5":e>=.5?t="cell-color-6":e>=.4?t="cell-color-7":e>=.3?t="cell-color-8":e>=.2?t="cell-color-9":e>=.1?t="cell-color-10":e>=0&&(t="cell-color-11"),t},changeSelection:function(e,t){"yes"==t?(1==e.target.checked&&(this.status="yes"),0==e.target.checked&&(this.status="unknown")):"no"==t?(1==e.target.checked&&(this.status="no"),0==e.target.checked&&(this.status="unknown")):"undecided"==t&&(1==e.target.checked&&(this.status="undecided"),0==e.target.checked&&(this.status="unknown"));var n={};n="yes"==this.status?{statusCode:"DONE",decision:!0}:"no"==this.status?{statusCode:"DONE",decision:!1}:"undecided"==this.status?{statusCode:"UDCB",decision:null}:{statusCode:"PNDG",decision:null},this.$emit("updateCuration",{key:this.occurrence.key,matching:n})},toggle:function(){this.expanded=!this.expanded}},beforeMount:function(){"DONE"==this.matching.statusCode?1==this.matching.decision?this.status="yes":0==this.matching.decision&&(this.status="no"):"UDCB"==this.matching.statusCode?this.status="undecided":this.status="unknown"}},A=y,k=(n("0177"),Object(f["a"])(A,u,l,!1,null,"b634466a",null)),E=k.exports,C=n("8a5d").default,O={name:"CurationList",mixins:[d["a"].mixin_fields],components:{CurationElement:E,PulseLoader:C},props:{show_back_button:{type:Boolean,required:!1,default:!0}},data:function(){return{in_progress:!0,occurrences:{},relations:[],empty_elements:[],change_list:{},changes:0,sort:{by:"$global",asc:!1},show_edit:!1,expanded:!1,pendingSave:[],action:null}},computed:Object(o["a"])(Object(o["a"])({},Object(a["c"])(["theme_color","curation_characteristics","user_query","fields","user","step","institutions"])),{},{cssVars:function(){return{"--color":this.theme_color.main,"--color-secondary":this.theme_color.secondary}},get_occurrence:function(){return this.occurrences[this.user_query.occurrence_key]},get_occurrence_name:function(){var e=this.fields[this.user_query.basisOfRecord].basisOfRecord_occurrence.name;return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},get_curation_name:function(){return this.fields[this.user_query.basisOfRecord].basisOfRecord_curation.name},get_description:function(){return"institutionKey"in this.occurrences[this.user_query.occurrence_key]?"from "+this.institutions[this.occurrences[this.user_query.occurrence_key].institutionKey]:""},get_mc:function(){return this.get_occurrence.references+this.get_occurrence.identifier.replace(".mc.","#")},to_process_curation:function(){return this.filterListToDo(this.relations,"PNDG")},finished_curation:function(){return this.filterListDone(this.relations,"PNDG")},finished_empty_elements:function(){return this.filterListDone(this.empty_elements,"PNDG")}}),methods:Object(o["a"])(Object(o["a"])({},Object(a["b"])(["updateOccurrenceKey","updateStep","updateUsername"])),{},{searchCurationAPI:function(){var e=this;this.$router.push({name:this.$router.currentRoute.name,query:Object(o["a"])(Object(o["a"])({},this.$router.currentRoute.query),{},{occurrenceKey:this.user_query.occurrence_key})}),this.changes=0,this.change_list={},this.in_progress=!0;var t=null;t=this.$backend.fetch_occurrence(this.user_query.occurrence_key),t.then((function(t){e.relations=t.data.occurrenceRelations,e.occurrences=t.data.occurrences;for(var n=0,i=Object.entries(e.occurrences);n<i.length;n++){var r=Object(s["a"])(i[n],2),c=r[0],o=r[1];o["key"]=c,e.occurrences[c]=o}e.in_progress=!1})).catch((function(e){console.log(e),alert("failed to load relations: "+e)}))},searchNextCurationAPI:function(){var e=this,t=null;t=this.$backend.fetch_next_occurrence_from_q(this.user_query,this.user_query.occurrence_key),t.then((function(t){e.updateOccurrenceKey(t.data.subjectOccurrenceKeys[0])})).catch((function(e){console.log(e),alert("failed to load next relations: "+e)}))},filterListToDo:function(e,t){var n=this,i=function(e){var t=n.$scoring.get_scores(n.occurrences[n.user_query.occurrence_key],n.occurrences[e.occurrenceKey2]),i=t[n.sort.by];return null!=i?parseFloat(i):-1};return this.sort.asc?e.sort((function(e,t){return i(e)-i(t)})):e.sort((function(e,t){return i(t)-i(e)})),e=e.filter((function(e){return e.statusCode==t})),e},filterListDone:function(e,t){return e.filter((function(e){return e.statusCode!=t}))},get_scores:function(e,t){return null==e||null==t?{$global:null}:this.$scoring.get_scores(e,t)},updateCuration:function(e){for(var t=0;t<this.relations.length;t++)this.relations[t].occurrenceKey2==e.key&&(this.relations[t].statusCode==e.matching.statusCode&&this.relations[t].decision==e.matching.decision?e.key in this.change_list&&delete this.change_list[e.key]:this.change_list[e.key]=e);this.changes=Object.keys(this.change_list).length},save:function(){this.pendingSave=Object.keys(this.change_list),this.$emitter.emit("ensureLogin")},nosaveBack:function(){var e=0==Object.keys(this.change_list).length||confirm("Are you sure you want to leaving without saving?");e&&(this.in_progress=!0,this.$emit("back"),this.$gtag.event("back"))},saveBack:function(){this.save(),this.action="back"},nosaveNext:function(){var e=0==Object.keys(this.change_list).length||confirm("Are you sure you want to continue without saving?");e&&this.searchNextCurationAPI()},saveNext:function(){this.save(),this.action="next"},sortBy:function(e){e==this.sort.by?this.sort.asc=!this.sort.asc:(this.sort.by=e,this.sort.asc=!1)},addLine:function(){var e={object:{}};e.object.key="",e.empty_key="emptykey_"+this.empty_elements.length,e.matching={},e.matching.match=null,this.empty_elements.push(e),this.addElement({key:e.empty_key,value:!0})},saveToSibBackend:function(e){var t,n={},i=Object(c["a"])(this.user_query.occurrence_key.relations);try{for(i.s();!(t=i.n()).done;){var r=t.value;n[r.object.key]={occurrence:Object(o["a"])({},r.object),decision:r.matching.match,is_new_decision:!1},delete n[r.object.key].occurrence.relations}}catch(u){i.e(u)}finally{i.f()}for(var s=0;s<e.length;s++)n[e[s]].decision=this.change_dict[this.change_list[s]],n[e[s]].is_new_decision=!0;var a={q:this.user_query.q,user:{name:this.user.name,orcid:this.user.orcid},refOccurrence:Object(o["a"])({},this.user_query.occurrence_key),relations:Object.values(n)};delete a.refOccurrence.relations,this.$backend.post_sib_matching(a).then((function(){})).catch((function(){}))},saveToPlaziBackend:function(e){for(var t=this,n=[],i=0;i<e.length;i++){var r={occurrenceKey1:this.user_query.occurrence_key,occurrenceKey2:e[i],decision:this.change_list[e[i]].matching.decision,statusCode:this.change_list[e[i]].matching.statusCode,userName:this.user.name,orcid:this.user.orcid};n.push(r)}var c={occurrenceRelations:n};this.$backend.post_matching(c).then((function(){t.change_list={},"back"==t.action?t.nosaveBack():"next"==t.action&&t.nosaveNext()})).catch((function(e){alert("Failed to save"+e)}))}}),mounted:function(){var e=this;this.$emitter.on("logged",(function(){if(e.pendingSave.length>0){var t=e.pendingSave.slice();e.pendingSave=[],e.saveToPlaziBackend(t),e.$gtag.event("save")}})),this.$emitter.on("loginAbort",(function(){e.pendingSave.length>0&&(e.pendingSave=[],alert("Your work is not saved"))}))},watch:{"user_query.occurrence_key":function(){null!=this.user_query.occurrence_key&&""!=this.user_query.occurrence_key&&"3"==this.step&&this.searchCurationAPI()}}},S=O,P=(n("ca96"),n("1039"),Object(f["a"])(S,i,r,!1,null,"0599e105",null));t["a"]=P.exports},"466d":function(e,t,n){"use strict";var i=n("c65b"),r=n("d784"),c=n("825a"),s=n("50c4"),o=n("577e"),a=n("1d80"),u=n("dc4a"),l=n("8aa5"),d=n("14c3");r("match",(function(e,t,n){return[function(t){var n=a(this),r=void 0==t?void 0:u(t,e);return r?i(r,t,n):new RegExp(t)[e](o(n))},function(e){var i=c(this),r=o(e),a=n(t,i,r);if(a.done)return a.value;if(!i.global)return d(i,r);var u=i.unicode;i.lastIndex=0;var h,m=[],_=0;while(null!==(h=d(i,r))){var p=o(h[0]);m[_]=p,""===p&&(i.lastIndex=l(r,s(i.lastIndex),u)),_++}return 0===_?null:m}]}))},"4e82":function(e,t,n){"use strict";var i=n("23e7"),r=n("e330"),c=n("59ed"),s=n("7b0b"),o=n("07fa"),a=n("577e"),u=n("d039"),l=n("addb"),d=n("a640"),h=n("04d1"),m=n("d998"),_=n("2d00"),p=n("512c"),g=[],f=r(g.sort),v=r(g.push),b=u((function(){g.sort(void 0)})),y=u((function(){g.sort(null)})),A=d("sort"),k=!u((function(){if(_)return _<70;if(!(h&&h>3)){if(m)return!0;if(p)return p<603;var e,t,n,i,r="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)g.push({k:t+i,v:n})}for(g.sort((function(e,t){return t.v-e.v})),i=0;i<g.length;i++)t=g[i].k.charAt(0),r.charAt(r.length-1)!==t&&(r+=t);return"DGBEFHACIJK"!==r}})),E=b||!y||!A||!k,C=function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:a(t)>a(n)?1:-1}};i({target:"Array",proto:!0,forced:E},{sort:function(e){void 0!==e&&c(e);var t=s(this);if(k)return void 0===e?f(t):f(t,e);var n,i,r=[],a=o(t);for(i=0;i<a;i++)i in t&&v(r,t[i]);l(r,C(e)),n=r.length,i=0;while(i<n)t[i]=r[i++];while(i<a)delete t[i++];return t}})},"512c":function(e,t,n){var i=n("342f"),r=i.match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},"671b":function(e,t,n){"use strict";n("73af")},6927:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJEAAACRCAYAAADD2FojAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAXEgAAFxIBZ5/SUgAABAVJREFUeAHtne1pG0EURTNCfdjpJJ0kqSTqJE4nKUWpZDOC/BBGCmNYuB97BAZ5Pey7756DJds/PC7z8YkHDaw18DqPXe+P3vwZ8+O6bdvL/Rd4TgOrDYwxPp9WD3OOBp41gETPmuH6cgNItFwVB581cOL90LNquL7awGm+MfqzephzNPCoAV7OHrXCtQ81gEQfqovDjxo4P7r4/tp8yfs1r13fX+fz7gbm++UfKxsuSTRvdPvF5HXlhpzpaWAy/7bygxcvZz3MZZsgkaz6nsFI1MNStgkSyarvGYxEPSxlmyCRrPqewUjUw1K2CRLJqu8ZjEQ9LGWbIJGs+p7BSNTDUrYJEsmq7xmMRD0sZZsgkaz6nsFI1MNStgkSyarvGYxEPSxlmyCRrPqewUjUw1K2CRLJqu8ZjEQ9LGWbIJGs+p7BSNTDUrYJEsmq7xmMRD0sZZsgkaz6nsFI1MNStgkSyarvGYxEPSxlmyCRrPqewUjUw1K2CRLJqu8ZjEQ9LGWbIJGs+p7BSNTDUrYJEsmq7xmMRD0sZZsgkaz6nsFI1MNStgkSyarvGYxEPSxlmyCRrPqewUjUw1K2CRLJqu8ZjEQ9LGWbIJGs+p7BSNTDUrYJEsmq7xmMRD0sZZsgkaz6nsFI1MNStgkSyarvGYxEPSxlmyCRrPqewUjUw1K2yVk1+d//XP+pmt80d4zxffb5ptqJ70Sq5ovmIlERTNUqSKRqvmguEhXBVK2CRKrmi+YiURFM1SpIpGq+aC4SFcFUrYJEquaL5iJREUzVKkikar5orvJvZ2+zx9sHj/AG+E4UDtAhPhI5UAjPgEThAB3iI5EDhfAMSBQO0CE+EjlQCM+AROEAHeIjkQOF8AxIFA7QIT4SOVAIz4BE4QAd4iORA4XwDEgUDtAhPhI5UAjPgEThAB3iI5EDhfAMSBQO0CE+EjlQCM+AROEAHeIjkQOF8AxIFA7QIT4SOVAIz4BE4QAd4iORA4XwDEgUDtAhPhI5UAjPgEThAB3iI5EDhfAMSBQO0CE+EjlQCM+AROEAHeIjkQOF8AxIFA7QIT4SOVAIz4BE4QAd4iORA4XwDEgUDtAhPhI5UAjPgEThAB3iI5EDhfAMSBQO0CE+EjlQCM+AROEAHeIjkQOF8AxIFA7QIT4SOVAIz4BE4QAd4iORA4XwDEgUDtAhPhI5UAjPgEThAB3iI5EDhfAMSBQO0CE+EjlQCM+AROEAHeIjkQOF8AznxfyX+bgunuVYSQPbtr2srLIk0bzZ15WbceaYDfBydkzuu26NRLvWecybIdExue+6NRLtWucxb4ZEx+S+69ZItGudx7wZEh2T+65b335PdBljvN7d9ct8/vvuc57SwH8b+AspFDJmv8EizgAAAABJRU5ErkJggg=="},"73af":function(e,t,n){},"8a5d":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"v-spinner"},[n("div",{staticClass:"v-pulse v-pulse1",style:[e.spinnerStyle,e.spinnerDelay1]}),n("div",{staticClass:"v-pulse v-pulse2",style:[e.spinnerStyle,e.spinnerDelay2]}),n("div",{staticClass:"v-pulse v-pulse3",style:[e.spinnerStyle,e.spinnerDelay3]})])},r=[],c={name:"PulseLoader",props:{loading:{type:Boolean,default:!0},color:{type:String,default:"#5dc596"},size:{type:String,default:"15px"},margin:{type:String,default:"2px"},radius:{type:String,default:"100%"}},data:function(){return{spinnerStyle:{backgroundColor:this.color,width:this.size,height:this.size,margin:this.margin,borderRadius:this.radius,display:"inline-block",animationName:"v-pulseStretchDelay",animationDuration:"0.75s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.2,.68,.18,1.08)",animationFillMode:"both"},spinnerDelay1:{animationDelay:"0.12s"},spinnerDelay2:{animationDelay:"0.24s"},spinnerDelay3:{animationDelay:"0.36s"}}}},s=c,o=(n("671b"),n("2877")),a=Object(o["a"])(s,i,r,!1,null,null,null);t["default"]=a.exports},"8d8a":function(e,t,n){},a694:function(e,t,n){},aace:function(e,t,n){"use strict";n("a694")},beea:function(e,t,n){},c5a5:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJEAAACRCAYAAADD2FojAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAXEgAAFxIBZ5/SUgAABHRJREFUeAHtnYFtGkEQRQNKH3Y6SScklUAncTpxOiGVXPYkpEE2l90bzWjR/IdkaX23O8u8/wTYxsfh0m5fuEFgjMBrm3a9n7r6c2hf12VZXu5PMIbAKIHD4fDtODqZeRDYIoBEW2Q4PkwAiYZRMXGLwJHXQ1toOD5K4NheGP0dncw8CDwiwNPZIyoc20UAiXbhYvIjAl8fHfx4rD3l/W7Hrh+P831tAu318nmkwyGJWqH1F5PXkYLMqUOgZf5j5Acvns7qZD6tEySahr7OxkhUJ8tpnSDRNPR1NkaiOllO6wSJpqGvszES1clyWidINA19nY2RqE6W0zpBomno62yMRHWynNYJEk1DX2djJKqT5bROkGga+jobI1GdLKd1gkTT0NfZGInqZDmtEySahr7OxkhUJ8tpnSDRNPR1Nh59o36djjc6ub0p/dfG6U+H1/+AWdd8OiF4gEciwdCjW0aiaKKC9ZBIMPTolpEomqhgPSQSDD26ZSSKJipYD4kEQ49uGYmiiQrWQyLB0KNbRqJoooL1kEgw9OiWkSiaqGA9JBIMPbplJIomKlgPiQRDj24ZiaKJCtZDIsHQo1tGomiigvWQSDD06JaRKJqoYD0kEgw9umUkiiYqWA+JBEOPbhmJookK1kMiwdCjW0aiaKKC9ZBIMPTolpEomqhgPSQSDD26ZSSKJipYD4kEQ49uGYmiiQrWQyLB0KNbRqJoooL1pl1ub+/l7bKzaZ//vmuLNv90Pp9PuxYlTW6X/vvZeL4lle+W5ZGoi4gJPQJI1CPE+S4BJOoiYkKPABL1CHG+SwCJuoiY0COARD1CnO8SQKIuIib0CCBRjxDnuwSQqIuICT0CSNQjxPkuASTqImJCj8DMv529tTu3fj3Fbe/f8vioKouNRyJjwchJAImc4FhmBJDIWDByEkAiJziWGQEkMhaMnASQyAmOZUYAiYwFIycBJHKCY5kRQCJjwchJAImc4FhmBJDIWDByEkAiJziWGQEkMhaMnASQyAmOZUYAiYwFIycBJHKCY5kRQCJjwchJAImc4FhmBJDIWDByEkAiJziWGQEkMhaMnASQyAmOZUYAiYwFIycBJHKCY5kRQCJjwchJAImc4FhmBJDIWDByEkAiJziWGQEkMhaMnASQyAmOZUYAiYwFIycBJHKCY5kRQCJjwchJAImc4FhmBKZdbs/uwvOM2iX0/uy4N+875paeikS3eG+fF/ZWOu2k5ng6SwKrVBaJlNJO6hWJksAqlUUipbSTekWiJLBKZZFIKe2kXpEoCaxSWSRSSjupVyRKAqtUFomU0k7qFYmSwCqVRSKltJN6RaIksEplkUgp7aRekSgJrFJZJFJKO6lXJEoCq1QWiZTSTuoViZLAKpVFIqW0k3odfaN+ex/75Zp0Hyj7pASWZXkZuWtDErVip5FizNEkwNOZZu6hXSNRKE7NYkikmXto10gUilOzGBJp5h7aNRKF4tQshkSauYd2vf6e6NIuqfJ6V/V7G7/ffc8QAv8l8A/RFE7lrzgAJAAAAABJRU5ErkJggg=="},ca96:function(e,t,n){"use strict";n("396c")},ce49:function(e,t,n){},d665:function(e,t,n){e.exports=n.p+"img/icon_comment.6f9de73d.png"},d998:function(e,t,n){var i=n("342f");e.exports=/MSIE|Trident/.test(i)},dd27:function(e,t,n){e.exports=n.p+"img/logo_ebiodiv_small.2a380f8c.png"},eb5f:function(e,t,n){"use strict";var i=n("2909"),r=(n("2af1"),n("4de4"),n("d3b7"),n("a15b"),n("d81d"),{PRESERVED_SPECIMEN:"Specimen",FOSSIL_SPECIMEN:"Fossil",LIVING_SPECIMEN:"Living Specimen",OBSERVATION:"Observation",HUMAN_OBSERVATION:"Human Observation",MACHINE_OBSERVATION:"Machine Observation",LITERATURE:"Literature Occurrence",MATERIAL_SAMPLE:"Material sample",OCCURRENCE:"Occurrence evidence",MATERIAL_CITATION:"Material citation",UNKNOWN:"Unknown evidence"}),c={TYPE:"Type",TYPE_SPECIES:"Type species",TYPE_GENUS:"Type genus",ALLOLECTOTYPE:"Allolectotype",ALLONEOTYPE:"Alloneotype",ALLOTYPE:"Allotype",COTYPE:"Cotype",EPITYPE:"Epitype",EXEPITYPE:"Ex-epitype",EXHOLOTYPE:"Ex-holotype",EXISOTYPE:"Ex-isotype",EXLECTOTYPE:"Ex-lectotype",EXNEOTYPE:"Ex-neotype",EXPARATYPE:"Ex-paratype",EXSYNTYPE:"Ex-syntype",EXTYPE:"Ex-type",HAPANTOTYPE:"Hapantotype",HOLOTYPE:"Holotype",ICONOTYPE:"Iconotype",ISOLECTOTYPE:"Isolectotype",ISONEOTYPE:"Isoneotype",ISOSYNTYPE:"Isosyntype",ISOTYPE:"Isotype",LECTOTYPE:"Lectotype",NEOTYPE:"Neotype",PARALECTOTYPE:"Paralectotype",PARANEOTYPE:"Paraneotype",PARATYPE:"Paratype",PLASTOHOLOTYPE:"Plastoholotype",PLASTOISOTYPE:"Plastoisotype",PLASTOLECTOTYPE:"Plastolectotype",PLASTONEOTYPE:"Plastoneotype",PLASTOPARATYPE:"Plastoparatype",PLASTOSYNTYPE:"Plastosyntype",PLASTOTYPE:"Plastotype",SECONDARYTYPE:"Secondary type",SUPPLEMENTARYTYPE:"Supplementary type",SYNTYPE:"Syntype",TOPOTYPE:"Topotype",ORIGINALMATERIAL:"Original material",NOTATYPE:"Not a type"},s=new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:3,maximumFractionDigits:3});t["a"]={mixin_fields:{methods:{display_value_decimalLatitude_decimalLongitude:function(e,t){if(null!=e&null!=t){var n=["S","","N"][1+Math.sign(e)],i=["W","","E"][1+Math.sign(t)];return s.format(e)+n+", "+s.format(t)+i}return null!=e&&null!=t||null==e&&null==t?"":e+", "+t},display_value_elevation_depth:function(e,t){return null!=e&&null==t?e:null==e&&null!=t?-t:null!=e&&null!=t?e+"/"+-t:""},display_value_day_month_year:function(e,t,n){var i=[e,t,n].filter((function(e){return null!=e}));return i.join("/")},display_value_typeStatus:function(e){var t=c[e];return null!=t?t:e},display_value_basisOfRecord:function(e){var t=r[e];return null!=t?t:e},display_content:function(e,t){var n=t.map((function(t){return e[t]})),r="display_value_"+t.join("_");return r in this?this[r].apply(this,Object(i["a"])(n)):n.filter((function(e){return null!=e})).join("/")}}}}},f748:function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},fde8:function(e,t,n){"use strict";n("ce49")}}]);
//# sourceMappingURL=home~occurrence~occurrenceList.59990034.js.map